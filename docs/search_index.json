[["normalmulti.html", "23 Distribución normal multivariada 23.1 Función de densidad 23.2 Simulando de una normal multivariada 23.3 Calculando probabilidades 23.4 Calculando cuantiles", " 23 Distribución normal multivariada En este capítulo se mostrarán aspectos importantes de la distribución normal multivariada. 23.1 Función de densidad En la densidad Normal \\(p\\)-variada, hay dos parámetros, \\(\\boldsymbol{\\mu}\\) y \\(\\boldsymbol{\\Sigma}\\). El primero es un vector de columna \\(p \\times 1\\) de parámetros de localización y una \\(p \\times p\\) matriz de dispersión \\(\\boldsymbol{\\Sigma}\\). La función de densidad de una normal multivariada es la siguiente: \\[\\begin{equation} f(\\mathbf{x} | \\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) =\\frac{1}{\\sqrt{(2\\pi)^{p}|\\boldsymbol{\\Sigma}|}} \\exp \\left( -\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^\\top\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}) \\right) \\end{equation}\\] El símbolo \\(|\\boldsymbol{\\Sigma}|\\) se refiere al determinante de la matriz \\(\\boldsymbol{\\Sigma}\\). Esta ecuación asume que \\(\\boldsymbol{\\Sigma}\\) se puede invertir, y una condición suficiente para la existencia de una inversa es que el determinante no sea \\(0\\). La matriz \\(\\boldsymbol{\\Sigma}\\) debe ser semidefinida positiva para asegurar que el punto más probable es \\(\\boldsymbol{\\mu}\\) y que, a medida que \\(\\mathbf{x}\\) se aleja de \\(\\boldsymbol{\\mu}\\) en cualquier dirección, entonces la probabilidad de observar \\(\\mathbf{x}\\) disminuye. Ejemplo Dibujar la superficie de una normal bivariada para las variables Peso y Estatura con vector de medias \\(\\boldsymbol{\\mu}^\\top=(65, 165)\\) y matriz de varianzas/covarianzas \\[ \\boldsymbol{\\Sigma}= \\begin{pmatrix} 20 &amp; 11 \\\\ 11 &amp; 30 \\end{pmatrix} \\] Solución Para crear una superficie de una normal bivariada se puede usar el siguiente código. La función dmvnorm del paquete mvtnorm (Genz et al. 2021) sirve para obtener la densidad de cada punto. library(mvtnorm) mu &lt;- c(65, 165) Sigma &lt;- matrix(c(20, 11, 11, 30), nrow=2 , byrow = TRUE) N &lt;- 50 Peso &lt;- seq(from=40, to=85, length.out=N) Estatura &lt;- seq(from=145, to=185, length.out=N) densidad_curva &lt;- function(x1, x2) dmvnorm(cbind(x1, x2), mean=mu, sigma=Sigma) probX &lt;- outer(Peso, Estatura, FUN=&quot;densidad_curva&quot;) persp(Peso, Estatura, probX, theta=45, phi=20, xlab=&quot;Peso&quot;,ylab=&quot;Estatura&quot;, zlab=&quot;&quot;, ticktype=&quot;detailed&quot;, nticks=4, col=&quot;khaki1&quot;) Figure 23.1: Densidad de una normal bivariada. Ejemplo Calcular la densidad dos personas \\(A=(60, 160)\\) y \\(B=(80, 170)\\) asumiendo distribución normal bivariada con vector de medias \\(\\boldsymbol{\\mu}^\\top=(65, 165)\\) y matriz de varianzas/covarianzas \\[ \\boldsymbol{\\Sigma}= \\begin{pmatrix} 20 &amp; 11 \\\\ 11 &amp; 30 \\end{pmatrix} \\] Solución Para calcular los valores de densidad de las dos personas hacemos lo siguiente: library(mvtnorm) mu &lt;- c(65, 165) Sigma &lt;- matrix(c(20, 11, 11, 30), nrow=2 , byrow = TRUE) dmvnorm(c(60, 160), mean=mu, sigma=Sigma) # Para A ## [1] 0.003502017 dmvnorm(c(80, 170), mean=mu, sigma=Sigma) # Para B ## [1] 2.103677e-05 Ejemplo Repetir las figuras de la densidad anterior pero usando otros paquetes. Solución library(rgl) plot3d(densidad_curva, col = colorRampPalette(c(&quot;blue&quot;, &quot;white&quot;)), xlab = &quot;Peso&quot;, ylab = &quot;Estatura&quot;, zlab = &quot;Den&quot;, xlim = c(40, 85), ylim = c(145, 185), aspect = c(1, 1, 0.5)) 23.2 Simulando de una normal multivariada Para simular de una normal multivariada se puede usar la función mvrnorm del paquete MASS (R-MASS?) o la función rmvnorm del paquete mvtnorm (Genz et al. 2021). Ejemplo Simular cien observaciones de pesos y estaturas y luego construir un diagrama de dispersión. Asuma que las variables tiene distribución normal bivariada con un vector de medias \\(\\boldsymbol{\\mu}^\\top=(65, 165)\\) y matriz de varianzas/covarianzas \\[ \\boldsymbol{\\Sigma}= \\begin{pmatrix} 20 &amp; 11 \\\\ 11 &amp; 30 \\end{pmatrix} \\] Solución Para hacer lo solicitado se puede usar el siguiente código. require(mvtnorm) mu &lt;- c(65, 165) Sigma &lt;- matrix(c(20, 11, 11, 30), ncol=2, nrow=2) n &lt;- 100 datos &lt;- rmvnorm(n=n, mean=mu, sigma=Sigma) plot(datos, xlab=&quot;Peso [kg]&quot;, ylab=&quot;Estatura [cm]&quot;, pch=19, las=1) points(x=mu[1], y=mu[2], lwd=3, col=&quot;tomato&quot;, pch=3) Figure 23.2: Diagrama de dispersión para datos simulados de una normal bivariada. Ejemplo Usando los datos simulados construya un diagrama de dispersión usando el paquete plotly. Solución library(mvtnorm) library(plotly) density &lt;- dmvnorm(datos, mean=mu, sigma=Sigma) plot_ly(x=~datos[,1], y=~datos[,2], z=~density, type = &quot;scatter3d&quot;, color=density) Figure 23.3: Densidad para los datos simulados de una normal bivariada usando plotly. Ejemplo Usando los datos simulados construya un diagrama de dispersión usando el paquete scatterplot3d. Solución library(scatterplot3d) scatterplot3d(x=datos[,1], y=datos[,2], z=density, pch=16, cex.lab=1, highlight.3d=TRUE, type=&quot;h&quot;, xlab=&quot;Peso&quot;, ylab=&quot;Estatura&quot;, zlab=&quot;Densidad&quot;) Figure 23.4: Densidad para los datos simulados de una normal bivariada usando scatterplot3d. 23.3 Calculando probabilidades La función pmvnorm del paquete mvtnorm sirve para calcular probabilidades. Este enlace lo llevará a la página oficial del paquete donde se puede encontrar una viñeta con información sobre el cálculo de probabilidades. Ejemplo Para el ejemplo de el peso y la estatura calcular la siguiente probabilidad. \\[ P(-\\infty &lt; Peso \\leq 60, -\\infty &lt; Estatura \\leq 160) \\] Solución Para hacer lo solicitado se puede usar el siguiente código. library(mvtnorm) mu &lt;- c(65, 165) Sigma &lt;- matrix(c(20, 11, 11, 30), ncol=2, nrow=2) pmvnorm(mean=mu, sigma=Sigma, lower=c(-Inf, -Inf), upper=c(60, 160)) ## [1] 0.05520382 ## attr(,&quot;error&quot;) ## [1] 1e-15 ## attr(,&quot;msg&quot;) ## [1] &quot;Normal Completion&quot; De la salida anterior tenemos que \\(P(-\\infty &lt; Peso \\leq 60, -\\infty &lt; Estatura \\leq 160)=0.1017746\\). 23.4 Calculando cuantiles La función qmvnorm del paquete mvtnorm sirve para calcular cuantiles. Ejemplo Para el ejemplo de el peso y la estatura calcular la siguiente probabilidad. library(mvtnorm) mu &lt;- c(65, 165) Sigma &lt;- matrix(c(20, 11, 11, 30), ncol=2, nrow=2) qmvnorm(p=0.1017746, mean=mu, sigma=Sigma, tail=&quot;lower.tail&quot;) ## $quantile ## [1] 158.0357 ## ## $f.quantile ## [1] -1.554312e-15 ## ## attr(,&quot;message&quot;) ## [1] &quot;Normal Completion&quot; References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
