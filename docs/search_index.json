[["normalmulti.html", "22 Distribución normal multivariada 22.1 Función de densidad 22.2 Simulando de una normal multivariada 22.3 Calculando probabilidades", " 22 Distribución normal multivariada En este capítulo se mostrarán aspectos importantes de la distribución normal multivariada. 22.1 Función de densidad La distribución MultiVariate Normal (MVN) tiene dos parámetros, pero cada uno de estos dos parámetros contiene más de una pieza de información. Un parámetro, \\(\\mu\\), describe la ubicación o punto central de la distribución, mientras que el otro parámetro determina la dispersión, el ancho de la propagación de lado a lado en los puntos observados. Figure 22.1: Densidad de una normal bivariada. En la densidad Normal multivariada, hay dos parámetros, \\(\\mu\\) y \\(\\Sigma\\). El primero es un vector de columna \\(n\\times1\\) de parámetros de ubicación y una \\(n\\times n\\) matriz de dispersión \\(\\Sigma\\). \\[\\begin{eqnarray} f(y_{i}|\\mu,\\Sigma) &amp; =\\nonumber \\\\ &amp; = &amp; f((y_{i1},y_{i2},...,y_{in})&#39;\\,|\\,\\mu=(\\mu_{1},...,\\mu_{n})&#39;,\\Sigma=\\left[\\begin{array}{ccc} \\sigma_{1}^{2} &amp; &amp; \\sigma_{1n}\\\\ &amp; \\ddots\\\\ \\sigma_{n1} &amp; &amp; \\sigma_{n}^{2} \\end{array}\\right])\\nonumber \\\\ &amp; &amp; =\\frac{1}{\\sqrt{(2\\pi)^{n}|\\Sigma|}}exp(-\\frac{1}{2}(y_{i}-\\mu)&#39;\\Sigma^{-1}(y_{i}-\\mu)) \\end{eqnarray}\\] El símbolo \\(|\\Sigma|\\) se refiere al determinante de la matriz \\(\\Sigma\\). El determinante es un solo número real. El símbolo \\(\\Sigma^{-1}\\) es el inverso de \\(\\Sigma,\\) una matriz para la cual \\(\\Sigma\\Sigma^{-1}=I.\\) Esta ecuación asume que \\(\\Sigma\\) se puede invertir, y una condición suficiente para la existencia de una inversa es que el determinante no sea \\(0\\). La matriz \\(\\Sigma\\) debe ser semidefinida positiva para asegurar que el punto más probable es \\(\\mu=(\\mu_{1},\\mu_{2},\\ldots,\\mu_{n})\\) y que, a medida que \\(y_{i}\\) se aleja de \\(\\mu\\) en cualquier dirección, entonces la probabilidad de observar \\(y_{i}\\) disminuye. El denominador en la fórmula del MVN es una constante de normalización, que nos asegura que la distribución se integra a 1.0. 22.2 Simulando de una normal multivariada Para simular de una normal multivariada se puede usar la función mvrnorm del paquete MASS (Ripley 2022). A continuación vamos a simular cien observaciones de peso y estatura con un vector de medias \\(\\mathbf{\\mu}^\\top=(65, 165)\\) y matriz de varianzas/covarianzas \\[ \\mathbf{\\Sigma}= \\begin{pmatrix} 20 &amp; 21 \\\\ 21 &amp; 30 \\end{pmatrix} \\] require(MASS) set.seed(1974) n &lt;- 100 mu &lt;- c(65, 165) Sigma &lt;- matrix(c(20, 21, 21, 30), ncol=2, nrow=2) datos &lt;- mvrnorm(n=n, mu=mu, Sigma=Sigma) plot(datos, xlab=&quot;Peso [kg]&quot;, ylab=&quot;Estatura [cm]&quot;) points(x=mu[1], y=mu[2], lwd=5, col=&quot;tomato&quot;, pch=3) Figure 22.2: Densidad de una normal bivariada. 22.3 Calculando probabilidades El paquete mvtnorm (Genz et al. 2021) calcula probabilidades, cuantiles, densidades y genera números aleatorios para las distribuciones multivariadas normales y \\(t\\). La función pmvnorm del paquete mvtnorm sirve para calcular probabilidades. Este enlace lo llevará a la página oficial del paquete donde se puede encontrar una viñeta con información sobre el cálculo de probabilidades. El siguiente código fue tomado de la viñeta del paquete e ilustra la forma de calcular la probabilidad \\(P()\\) para una normal con \\(\\mathbf{\\mu}\\) y \\(\\mathbf{\\Sigma}\\) como se muestran en el código. \\[ P(-\\infty &lt; X_1 \\leq 1, -\\infty &lt; X_2 \\leq 4, -\\infty &lt; X_3 \\leq 2) \\] library(mvtnorm) m &lt;- 3 sigma &lt;- diag(3) sigma[2,1] &lt;- 3/5 sigma[3,1] &lt;- 1/3 sigma[3,2] &lt;- 11/15 pmvnorm(mean=rep(0, m), sigma, lower=rep(-Inf, m), upper=c(1,4,2)) ## [1] 0.8279848 ## attr(,&quot;error&quot;) ## [1] 7.328965e-07 ## attr(,&quot;msg&quot;) ## [1] &quot;Normal Completion&quot; References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
